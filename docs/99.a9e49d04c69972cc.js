"use strict";(self.webpackChunktest_ng4=self.webpackChunktest_ng4||[]).push([[99],{68099:(eo,E,s)=>{s.r(E),s.d(E,{MyaccountsModule:()=>Xr});var S=s(36895),g=s(24006),D=s(70585),F=s(21493),j=s(32137),v=s(10805),L=s(97932),V=s(35593),Z=s(66058),M=s(34793),he=s(49146),ye=s(27988),ve=s(95343),_e=s(7585),Ce=s(53858);const _=function(){try{var e=(0,Ce.Z)(Object,"defineProperty");return e({},"",{}),e}catch{}}(),N=function xe(e,r,n){"__proto__"==r&&_?_(e,r,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[r]=n};var Se=s(93093),Te=Object.prototype.hasOwnProperty;const B=function Oe(e,r,n){var o=e[r];(!Te.call(e,r)||!(0,Se.Z)(o,n)||void 0===n&&!(r in e))&&N(e,r,n)},y=function Ie(e,r,n,o){var i=!n;n||(n={});for(var a=-1,c=r.length;++a<c;){var d=r[a],u=o?o(n[d],e[d],d,n,e):void 0;void 0===u&&(u=e[d]),i?N(n,d,u):B(n,d,u)}return n};var U=s(94157);var we=s(73487),T=s(71999),R=s(11986);var je=Object.prototype.hasOwnProperty;const Ve=function Le(e){if(!(0,T.Z)(e))return function Ee(e){var r=[];if(null!=e)for(var n in Object(e))r.push(n);return r}(e);var r=(0,R.Z)(e),n=[];for(var o in e)"constructor"==o&&(r||!je.call(e,o))||n.push(o);return n};var Ze=s(78706);const O=function Ne(e){return(0,Ze.Z)(e)?(0,we.Z)(e,!0):Ve(e)};var Re=s(25946),G="object"==typeof exports&&exports&&!exports.nodeType&&exports,K=G&&"object"==typeof module&&module&&!module.nodeType&&module,z=K&&K.exports===G?Re.Z.Buffer:void 0,$=z?z.allocUnsafe:void 0;var J=s(23033);var Y=s(6623);const I=(0,s(65820).Z)(Object.getPrototypeOf,Object);var Xe=s(33419);const W=Object.getOwnPropertySymbols?function(e){for(var r=[];e;)(0,Y.Z)(r,(0,J.Z)(e)),e=I(e);return r}:Xe.Z;var nt=s(28501),rt=s(18203);const H=function ot(e){return(0,rt.Z)(e,O,W)};var P=s(84116),at=Object.prototype.hasOwnProperty;var Q=s(71630);const A=function lt(e){var r=new e.constructor(e.byteLength);return new Q.Z(r).set(new Q.Z(e)),r};var pt=/\w*$/;var C=s(38492),X=C.Z?C.Z.prototype:void 0,k=X?X.valueOf:void 0;const Bt=function Nt(e,r,n){var o=e.constructor;switch(r){case"[object ArrayBuffer]":return A(e);case"[object Boolean]":case"[object Date]":return new o(+e);case"[object DataView]":return function dt(e,r){var n=r?A(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function yt(e,r){var n=r?A(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,n);case"[object Map]":case"[object Set]":return new o;case"[object Number]":case"[object String]":return new o(e);case"[object RegExp]":return function gt(e){var r=new e.constructor(e.source,pt.exec(e));return r.lastIndex=e.lastIndex,r}(e);case"[object Symbol]":return function mt(e){return k?Object(k.call(e)):{}}(e)}};var q=Object.create;const Rt=function(){function e(){}return function(r){if(!(0,T.Z)(r))return{};if(q)return q(r);e.prototype=r;var n=new e;return e.prototype=void 0,n}}();var ee=s(14177),zt=s(85202),w=s(214);var te=s(66932),b=s(76594),ne=b.Z&&b.Z.isMap;const Ht=ne?(0,te.Z)(ne):function Jt(e){return(0,w.Z)(e)&&"[object Map]"==(0,P.Z)(e)};var re=b.Z&&b.Z.isSet;const en=re?(0,te.Z)(re):function Xt(e){return(0,w.Z)(e)&&"[object Set]"==(0,P.Z)(e)};var oe="[object Arguments]",ie="[object Function]",ae="[object Object]",l={};l[oe]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object DataView]"]=l["[object Boolean]"]=l["[object Date]"]=l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Map]"]=l["[object Number]"]=l[ae]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object Symbol]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l["[object Error]"]=l[ie]=l["[object WeakMap]"]=!1;const Pn=function x(e,r,n,o,i,a){var c,d=1&r,u=2&r,kr=4&r;if(n&&(c=i?n(e,o,i,a):n(e)),void 0!==c)return c;if(!(0,T.Z)(e))return e;var pe=(0,ee.Z)(e);if(pe){if(c=function st(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&at.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!d)return function $e(e,r){var n=-1,o=e.length;for(r||(r=Array(o));++n<o;)r[n]=e[n];return r}(e,c)}else{var h=(0,P.Z)(e),ge=h==ie||"[object GeneratorFunction]"==h;if((0,zt.Z)(e))return function Ke(e,r){if(r)return e.slice();var n=e.length,o=$?$(n):new e.constructor(n);return e.copy(o),o}(e,d);if(h==ae||h==oe||ge&&!i){if(c=u||ge?{}:function Gt(e){return"function"!=typeof e.constructor||(0,R.Z)(e)?{}:Rt(I(e))}(e),!d)return u?function et(e,r){return y(e,W(e),r)}(e,function Be(e,r){return e&&y(r,O(r),e)}(c,e)):function Ye(e,r){return y(e,(0,J.Z)(e),r)}(e,function Pe(e,r){return e&&y(r,(0,U.Z)(r),e)}(c,e))}else{if(!l[h])return i?e:{};c=Bt(e,h,d)}}a||(a=new ve.Z);var fe=a.get(e);if(fe)return fe;a.set(e,c),en(e)?e.forEach(function(p){c.add(x(p,r,n,p,e,a))}):Ht(e)&&e.forEach(function(p,f){c.set(f,x(p,r,n,f,e,a))});var me=pe?void 0:(kr?u?H:nt.Z:u?O:U.Z)(e);return(0,_e.Z)(me||e,function(p,f){me&&(p=e[f=p]),B(c,f,x(p,r,n,f,e,a))}),c};var se=s(25575);var En=s(97298);const Ln=function jn(e,r){return r.length<2?e:(0,En.Z)(e,function Dn(e,r,n){var o=-1,i=e.length;r<0&&(r=-r>i?0:i+r),(n=n>i?i:n)<0&&(n+=i),i=r>n?0:n-r>>>0,r>>>=0;for(var a=Array(i);++o<i;)a[o]=e[o+r];return a}(r,0,-1))};var Vn=s(62168);const Nn=function Zn(e,r){return r=(0,se.Z)(r,e),null==(e=Ln(e,r))||delete e[(0,Vn.Z)(function An(e){var r=null==e?0:e.length;return r?e[r-1]:void 0}(r))]};var Bn=s(77079),ce=Function.prototype.toString,Kn=Object.prototype.hasOwnProperty,zn=ce.call(Object);const Wn=function Yn(e){return function $n(e){if(!(0,w.Z)(e)||"[object Object]"!=(0,Bn.Z)(e))return!1;var r=I(e);if(null===r)return!0;var n=Kn.call(r,"constructor")&&r.constructor;return"function"==typeof n&&n instanceof n&&ce.call(n)==zn}(e)?void 0:e};var Hn=s(24825),le=C.Z?C.Z.isConcatSpreadable:void 0;const Xn=function Qn(e){return(0,ee.Z)(e)||(0,Hn.Z)(e)||!!(le&&e&&e[le])},kn=function de(e,r,n,o,i){var a=-1,c=e.length;for(n||(n=Xn),i||(i=[]);++a<c;){var d=e[a];r>0&&n(d)?r>1?de(d,r-1,n,o,i):(0,Y.Z)(i,d):o||(i[i.length]=d)}return i},er=function qn(e){return null!=e&&e.length?kn(e,1):[]},nr=function tr(e,r,n){switch(n.length){case 0:return e.call(r);case 1:return e.call(r,n[0]);case 2:return e.call(r,n[0],n[1]);case 3:return e.call(r,n[0],n[1],n[2])}return e.apply(r,n)};var ue=Math.max;const ar=function ir(e){return function(){return e}};var sr=s(79940),dr=800,ur=16,pr=Date.now;const mr=function gr(e){var r=0,n=0;return function(){var o=pr(),i=ur-(o-n);if(n=o,i>0){if(++r>=dr)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}(_?function(e,r){return _(e,"toString",{configurable:!0,enumerable:!1,value:ar(r),writable:!0})}:sr.Z),xr=function hr(e){return mr(function rr(e,r,n){return r=ue(void 0===r?e.length-1:r,0),function(){for(var o=arguments,i=-1,a=ue(o.length-r,0),c=Array(a);++i<a;)c[i]=o[r+i];i=-1;for(var d=Array(r+1);++i<r;)d[i]=o[i];return d[r]=n(c),nr(e,this,d)}}(e,void 0,er),e+"")}(function(e,r){var n={};if(null==e)return n;var o=!1;r=(0,ye.Z)(r,function(a){return a=(0,se.Z)(a,e),o||(o=a.length>1),a}),y(e,H(e),n),o&&(n=Pn(n,7,Wn));for(var i=r.length;i--;)Nn(n,r[i]);return n});var t=s(94650),m=s(72164);let Sr=(()=>{class e{transform(n,o){return n&&o?n.filter(i=>i.isPrivate===o.isPrivate):n}static#e=this.\u0275fac=function(o){return new(o||e)};static#t=this.\u0275pipe=t.\u0275\u0275definePipe({name:"fieldsFilter",type:e,pure:!1})}return e})();const Mr=function(){return{"padding-left":"9px","z-index":"1201"}};function Tr(e,r){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"p-calendar",25),t.\u0275\u0275listener("ngModelChange",function(i){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.criteria.startingDate=i)}),t.\u0275\u0275elementEnd()}if(2&e){const n=t.\u0275\u0275nextContext(2);t.\u0275\u0275styleMap(t.\u0275\u0275pureFunction0(5,Mr)),t.\u0275\u0275property("ngModel",n.criteria.startingDate)("disabled",n.loadingCS)("inline",!0)}}function Or(e,r){if(1&e&&(t.\u0275\u0275elementStart(0,"option",26),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&e){const n=r.$implicit;t.\u0275\u0275propertyInterpolate("value",n.code),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.name," ")}}function Ir(e,r){if(1&e&&(t.\u0275\u0275elementStart(0,"option",26),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&e){const n=r.$implicit;t.\u0275\u0275propertyInterpolate("value",n.code),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.name," ")}}function Pr(e,r){if(1&e&&(t.\u0275\u0275elementStart(0,"option",26),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&e){const n=r.$implicit;t.\u0275\u0275propertyInterpolate("value",n._id),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(n.csName)}}const Ar=function(){return{isPrivate:!1}},wr=function(e){return{mask:e,guide:!1}};function Er(e,r){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div")(1,"div",14)(2,"div",15),t.\u0275\u0275template(3,Tr,1,6,"p-calendar",16),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"div",14)(5,"div",17)(6,"select",18),t.\u0275\u0275listener("change",function(){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.getProductsByRegionBrand())})("ngModelChange",function(i){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.criteria.region=i)}),t.\u0275\u0275elementStart(7,"option",19),t.\u0275\u0275text(8,"Choose a region"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(9,Or,2,2,"option",20),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(10,"div",14)(11,"div",17)(12,"select",21),t.\u0275\u0275listener("change",function(){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.getProductsByRegionBrand())})("ngModelChange",function(i){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.criteria.brandName=i)}),t.\u0275\u0275elementStart(13,"option",19),t.\u0275\u0275text(14,"Choose a brand"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(15,Ir,2,2,"option",20),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(16,"div",14)(17,"div",17)(18,"select",22),t.\u0275\u0275listener("ngModelChange",function(i){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.criteria.productCode=i)}),t.\u0275\u0275elementStart(19,"option",19),t.\u0275\u0275text(20,"Choose a product reference"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(21,"option",23),t.\u0275\u0275text(22,"Empty Account"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(23,Pr,2,2,"option",20),t.\u0275\u0275pipe(24,"fieldsFilter"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(25,"div",14)(26,"div",17)(27,"input",24),t.\u0275\u0275listener("ngModelChange",function(i){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.criteria.numberOfPax=i)}),t.\u0275\u0275elementEnd()()()()}if(2&e){const n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",n.display),t.\u0275\u0275advance(3),t.\u0275\u0275property("disabled",n.productsListLoading||n.loadingCS)("ngModel",n.criteria.region),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",n.regionList),t.\u0275\u0275advance(3),t.\u0275\u0275property("disabled",n.productsListLoading||n.loadingCS)("ngModel",n.criteria.brandName),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",n.brandList),t.\u0275\u0275advance(3),t.\u0275\u0275property("disabled",n.productsListLoading||n.loadingCS)("ngModel",n.criteria.productCode),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind2(24,13,n.allProductsList,t.\u0275\u0275pureFunction0(16,Ar))),t.\u0275\u0275advance(4),t.\u0275\u0275property("textMask",t.\u0275\u0275pureFunction1(17,wr,n.positiveValuesMask))("disabled",n.loadingCS||"OFF"===n.criteria.productCode)("ngModel",n.criteria.numberOfPax)}}function Dr(e,r){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",27),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.newEmptyAccount(i.criteria))}),t.\u0275\u0275elementEnd()}}function Fr(e,r){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",27),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.searchByCriteria(i.criteria))}),t.\u0275\u0275elementEnd()}}function jr(e,r){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",28),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.cancelGenerate())}),t.\u0275\u0275elementEnd()}}const Lr=function(){return{position:"static",width:"50px",height:"50px"}};function Vr(e,r){1&e&&t.\u0275\u0275element(0,"p-progressSpinner",29),2&e&&t.\u0275\u0275styleMap(t.\u0275\u0275pureFunction0(2,Lr))}function Zr(e,r){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",45),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext().$implicit,a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.editDeparture(i._id))}),t.\u0275\u0275element(1,"i",46),t.\u0275\u0275elementEnd()}}function Nr(e,r){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",45),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext().$implicit,a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.deleteDeparture(i))}),t.\u0275\u0275element(1,"i",47),t.\u0275\u0275elementEnd()}}function Br(e,r){1&e&&t.\u0275\u0275element(0,"i",48)}function Ur(e,r){1&e&&t.\u0275\u0275element(0,"i",49)}function Rr(e,r){1&e&&t.\u0275\u0275element(0,"i",50)}function Gr(e,r){1&e&&t.\u0275\u0275element(0,"i",51)}function Kr(e,r){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",34)(1,"li",35)(2,"div",34)(3,"div",36),t.\u0275\u0275text(4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",37),t.\u0275\u0275listener("click",function(){const a=t.\u0275\u0275restoreView(n).$implicit,c=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(c.viewDeparture(a._id))}),t.\u0275\u0275text(6),t.\u0275\u0275element(7,"i",38),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(8,Zr,2,0,"div",39),t.\u0275\u0275template(9,Nr,2,0,"div",39),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(10,"div",40),t.\u0275\u0275template(11,Br,1,0,"i",41),t.\u0275\u0275template(12,Ur,1,0,"i",42),t.\u0275\u0275template(13,Rr,1,0,"i",43),t.\u0275\u0275template(14,Gr,1,0,"i",44),t.\u0275\u0275elementEnd()()}if(2&e){const n=r.$implicit;t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" #",n.position," "),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",n.tripCode," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf","draft"===n.state||"rejected"===n.state),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","draft"===n.state||"rejected"===n.state),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf","draft"===n.state),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","submitted"===n.state),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","validated"===n.state),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","rejected"===n.state)}}function zr(e,r){if(1&e&&(t.\u0275\u0275elementStart(0,"div",52),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&e){const n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(n.unavailableDepartures)}}function $r(e,r){if(1&e&&(t.\u0275\u0275elementStart(0,"div",30)(1,"ul",31),t.\u0275\u0275template(2,Kr,15,8,"div",32),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(3,zr,2,1,"div",33),t.\u0275\u0275elementEnd()),2&e){const n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",n.allDepartures),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",0==n.allDepartures.length&&!n.loadingData)}}function Jr(e,r){1&e&&t.\u0275\u0275element(0,"p-progressSpinner")}const Yr=function(){return{width:"600px"}},Wr=function(){return{"960px":"30vw"}},Hr=[{path:"",component:(()=>{class e{constructor(n,o,i,a,c){this.confirmationService=n,this.router=o,this.datastoreService=i,this.userService=a,this.notificationService=c,this.currentUser={},this.allDepartures=[],this.msgs=[],this.display=!1,this.loadingData=!1,this.isEdit=!1,this.hasError=!1,this.hasResult=!1,this.apiCallLoading=!1,this.isEmptyAccount=!1,this.productsListLoading=!1,this.loadingCS=!1,this.productsDetailArray=[],this.brands=["Gecko"],this.allProductsList=[],this.criteria={startingDate:"",region:"",brandName:"",productCode:"",numberOfPax:""},this.savedCriteria={},this.departureObjectParam={},this.departureObject={},this.notification="",this.csDialogTitle="",this.unavailableDepartures="",this.latestPosition=0,this.validationResult=[],this.emptyAccountsDateMask=[0,1,"/",/[0-1]/,/[0-2]/,"/",/[0-2]/,/[0-9]/,/[0-9]/,/[0-9]/],this.positiveValuesMask=[/^[0-9]\d*$/,/^[0-9]\d*$/],this.brandList=[],this.regionList=[],this.fullRegionList=[]}ngOnInit(){this.loadingData=!0;const n=JSON.parse(localStorage.getItem("appConfig"));this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.brandList=n.brands,this.fullRegionList=n.regions,this.regionList=this.regionsByLeaderID(this.currentUser.regions),this.getAllDeparturesByUserForList(this.currentUser._id)}regionsByLeaderID(n){let o=[];return n.forEach(i=>{this.fullRegionList.forEach(a=>{a.code===i&&o.push(a)})}),o}getProductsByRegionBrand(){""!==this.criteria.region&&""!==this.criteria.brandName&&(this.productsListLoading=!0,this.datastoreService.getProductsByRegionBrand(this.criteria.region,this.criteria.brandName).subscribe(n=>{this.allProductsList=n.data,this.productsListLoading=!1,this.deactivateSpinner()},n=>{console.log(n),this.productsListLoading=!1,this.deactivateSpinner()}))}getAllDeparturesByUserForList(n){this.datastoreService.getAllDeparturesByUserForList(n).subscribe(o=>{o.ok?(this.allDepartures=o.data.sort((i,a)=>a.position-i.position),this.allDepartures.length>0?this.latestPosition=Math.max.apply(Math,this.allDepartures.map(i=>i.position)):(this.latestPosition=0,this.unavailableDepartures="You currently have no departures.")):this.notificationService.addSingle("info","An error occured !",o.message),this.deactivateSpinner()},o=>{console.log(o)})}deleteDeparture(n){this.confirmationService.confirm({message:"Do you want to delete this record?",header:"Delete Confirmation",icon:"fa fa-trash",accept:()=>{this.datastoreService.deleteDeparture(n._id).subscribe(o=>{this.getAllDeparturesByUserForList(this.currentUser._id),o.ok?this.notificationService.addSingle("info","Item Deleted !","You've successfully deleted "+n.tripCode+"."):this.notificationService.addSingle("error","An error occured !",o.message)},o=>{console.log("error :",o)})},reject:()=>{console.log("Rejected")}})}deactivateSpinner(){!this.productsListLoading&&!this.loadingCS&&(this.loadingData=!1)}showDialog(){this.csDialogTitle=this.isEmptyAccount?"Generate New Empty Account":"Generate New Costing Sheets",this.display=!0}cancelGenerate(){this.display=!1,this.criteria={startingDate:"",region:"",brandName:"",productCode:"",numberOfPax:""}}viewDeparture(n){this.router.navigate(["/myaccounts/",n,"view"])}editDeparture(n){this.router.navigate(["/myaccounts/",n,"edit"])}newEmptyAccount(n){this.loadingCS=!0,isNaN(Date.parse(n.startingDate))?(this.notificationService.addSingle("error","Invalid Date","Date entered is invalid"),this.loadingCS=!1,this.deactivateSpinner()):(n.isEmptyAccount=!0,this.getJsonData(n))}searchByCriteria(n){if(this.loadingCS=!0,this.validationResult=this.isSearchCriteriaValid(n),0===this.validationResult.length)this.apiCallLoading=!0,n.isEmptyAccount=!1,this.getJsonData(n);else{for(let o=0;o<this.validationResult.length;o++)this.notificationService.addSingle("warn","Validation Warning",this.validationResult[o].message);this.hasError=!0,this.hasResult=!1,this.apiCallLoading=!1,this.loadingCS=!1}}isSearchCriteriaValid(n){let o=[];return n.startingDate||o.push({isValid:!1,message:"Starting date is required"}),n.region||o.push({isValid:!1,message:"Region code is required"}),n.brandName||o.push({isValid:!1,message:"Brand code is required"}),n.productCode||o.push({isValid:!1,message:"Product code is required"}),n.numberOfPax||o.push({isValid:!1,message:"Number of pax is required"}),isNaN(n.numberOfPax)&&o.push({isValid:!1,message:"Number of pax must be a valid number"}),o}getJsonData(n){n.leaderID=null,this.savedCriteria=n,this.departureObject=n,this.datastoreService.getExpensesByCriteria(n).subscribe(o=>{o.position=this.latestPosition+1,this.getCurrentUserVarInfo(o)})}assignCashSummary(n){n.cashSummary=[],0===this.currentUser.cashOnHand.length?this.currentUser.initialCOH.forEach(o=>{n.cashSummary.push({currency:o.currency,startCash:o.cash,endingCash:o.cash})}):this.currentUser.cashOnHand.forEach(o=>{n.cashSummary.push({currency:o.currency,startCash:o.cash,endingCash:o.cash})}),localStorage.setItem("departure",JSON.stringify(n)),this.hasResult=!0,this.hasError=!1,this.apiCallLoading=!1,this.deactivateSpinner(),this.display=!1,this.router.navigate(["/myaccounts/","0","creation"])}getCurrentUserVarInfo(n){this.userService.getCurrentUserVarInfo().subscribe(o=>{o.ok?(this.updateStoredCurrentUser(o.data),this.assignCashSummary(n)):this.notificationService.addSingle("error","An error occured !",o.message)},o=>{console.log(o)})}updateStoredCurrentUser(n){he.Z(xr(n,["_id","userCode"]),(o,i)=>{this.currentUser[i]=o}),localStorage.setItem("currentUser",JSON.stringify(this.currentUser))}static#e=this.\u0275fac=function(o){return new(o||e)(t.\u0275\u0275directiveInject(v.YP),t.\u0275\u0275directiveInject(M.F0),t.\u0275\u0275directiveInject(m.Mi),t.\u0275\u0275directiveInject(m.KD),t.\u0275\u0275directiveInject(m.gq))};static#t=this.\u0275cmp=t.\u0275\u0275defineComponent({type:e,selectors:[["app-myaccounts"]],decls:20,vars:17,consts:[[1,"row","justify-content-end"],[1,"col"],[1,"text-muted",2,"text-align","left"],[1,"col-lg-3","col-md-3","col-sm-4"],["type","button",1,"btn","peak-save-button",2,"width","140px",3,"disabled","click"],["header","Generate New Costing Sheets",3,"visible","modal","breakpoints","draggable","resizable","transitionOptions","visibleChange"],["pTemplate","content"],[1,"row","justify-content-center",2,"margin","10px 5px"],["type","button","pButton","","icon","fa fa-check","label","Generate","style","min-width: 130px",3,"click",4,"ngIf"],["type","button","pButton","","icon","fa fa-close","label","Cancel","style","min-width: 130px","class","p-button-secondary",3,"click",4,"ngIf"],["strokeWidth","2",3,"style",4,"ngIf"],[1,"row","justify-content-center"],["class","col-lg-11 col-md-12 col-sm-12",4,"ngIf"],[4,"ngIf"],[1,"row","justify-content-center","rows-spacing"],[1,"col-lg-10","col-md-10","col-sm-12","justify-content-center",2,"display","inline-flex"],["appendTo","body","name","date-picker","dateFormat","dd/mm/yy",3,"ngModel","style","disabled","inline","ngModelChange",4,"ngIf"],[1,"col-lg-8","col-md-10","col-sm-12"],["name","region",1,"form-control",3,"disabled","ngModel","change","ngModelChange"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["name","brandName",1,"form-control",3,"disabled","ngModel","change","ngModelChange"],["name","productReference",1,"form-control",3,"disabled","ngModel","ngModelChange"],["value","OFF"],["type","text","id","numberOfPax","placeholder","Enter number of pax",1,"form-control",3,"textMask","disabled","ngModel","ngModelChange"],["appendTo","body","name","date-picker","dateFormat","dd/mm/yy",3,"ngModel","disabled","inline","ngModelChange"],[3,"value"],["type","button","pButton","","icon","fa fa-check","label","Generate",2,"min-width","130px",3,"click"],["type","button","pButton","","icon","fa fa-close","label","Cancel",1,"p-button-secondary",2,"min-width","130px",3,"click"],["strokeWidth","2"],[1,"col-lg-11","col-md-12","col-sm-12"],[1,"list-group"],["class","row",4,"ngFor","ngForOf"],["style","font-size: 20px;color: grey;text-align: center;border-radius: 10px;padding: 15px;",4,"ngIf"],[1,"row"],[1,"col-md-11","col-lg-11","list-group-item"],[1,"col-1","text-center",2,"padding","10px","max-width","70px !important"],[1,"col-lg-10","col-md-10","col-sm-10","action-buttons",2,"padding","10px",3,"click"],["aria-hidden","true",1,"fa","fa-eye",2,"float","right","line-height","1.5"],["class","col action-buttons text-center","style","padding: 10px; max-width: 80px !important;",3,"click",4,"ngIf"],[1,"col","text-center",2,"margin-bottom","auto","margin-top","auto","max-width","70px !important"],["class","fa fa-copy","aria-hidden","true","style","font-size: 32px; color: gray;",4,"ngIf"],["class","fa fa-spinner","aria-hidden","true","style","font-size: 32px; color: orange;",4,"ngIf"],["class","fa fa-check-circle","aria-hidden","true","style","font-size: 32px; color: forestgreen;",4,"ngIf"],["class","fa fa-ban","aria-hidden","true","style","font-size: 32px; color: darkred;",4,"ngIf"],[1,"col","action-buttons","text-center",2,"padding","10px","max-width","80px !important",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],["aria-hidden","true",1,"fa","fa-trash"],["aria-hidden","true",1,"fa","fa-copy",2,"font-size","32px","color","gray"],["aria-hidden","true",1,"fa","fa-spinner",2,"font-size","32px","color","orange"],["aria-hidden","true",1,"fa","fa-check-circle",2,"font-size","32px","color","forestgreen"],["aria-hidden","true",1,"fa","fa-ban",2,"font-size","32px","color","darkred"],[2,"font-size","20px","color","grey","text-align","center","border-radius","10px","padding","15px"]],template:function(o,i){1&o&&(t.\u0275\u0275elementStart(0,"div")(1,"div",0)(2,"div",1)(3,"h2",2),t.\u0275\u0275text(4,"My Accounts"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(5,"div",3)(6,"button",4),t.\u0275\u0275listener("click",function(){return i.showDialog()}),t.\u0275\u0275text(7,"New Account"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(8,"p-dialog",5),t.\u0275\u0275listener("visibleChange",function(c){return i.display=c}),t.\u0275\u0275template(9,Er,28,19,"ng-template",6),t.\u0275\u0275elementStart(10,"p-footer",7),t.\u0275\u0275template(11,Dr,1,0,"button",8),t.\u0275\u0275template(12,Fr,1,0,"button",8),t.\u0275\u0275template(13,jr,1,0,"button",9),t.\u0275\u0275template(14,Vr,1,3,"p-progressSpinner",10),t.\u0275\u0275elementEnd()(),t.\u0275\u0275element(15,"hr"),t.\u0275\u0275elementStart(16,"div",11),t.\u0275\u0275template(17,$r,4,2,"div",12),t.\u0275\u0275template(18,Jr,1,0,"p-progressSpinner",13),t.\u0275\u0275elementEnd()(),t.\u0275\u0275element(19,"p-confirmDialog")),2&o&&(t.\u0275\u0275advance(6),t.\u0275\u0275property("disabled",i.loadingData),t.\u0275\u0275advance(2),t.\u0275\u0275styleMap(t.\u0275\u0275pureFunction0(15,Yr)),t.\u0275\u0275property("visible",i.display)("modal",!0)("breakpoints",t.\u0275\u0275pureFunction0(16,Wr))("draggable",!1)("resizable",!1)("transitionOptions","0ms"),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf","OFF"===i.criteria.productCode&&!i.loadingCS),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","OFF"!==i.criteria.productCode&&!i.loadingCS),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.loadingCS),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.loadingCS),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",!i.loadingData),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.loadingData))},dependencies:[S.NgForOf,S.NgIf,g.NgSelectOption,g.\u0275NgSelectMultipleOption,g.DefaultValueAccessor,g.SelectControlValueAccessor,g.NgControlStatus,g.NgModel,D.f,V.Hq,v.$_,v.jx,F.V,j.Q,L.G,Z.hd,Sr],styles:['.list-group-item[_ngcontent-%COMP%]:focus, .list-group-item[_ngcontent-%COMP%]:hover{background:rgba(0,150,199,.69);color:#fff}.action-buttons[_ngcontent-%COMP%]{padding:0 15px;border:1px solid #a09393;border-width:0 0 0 1px}.action-buttons[_ngcontent-%COMP%]:focus, .action-buttons[_ngcontent-%COMP%]:hover{z-index:1;cursor:pointer}.action-buttons[_ngcontent-%COMP%]:focus   i[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{text-decoration:underline}.rows-spacing[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}.marquee[_ngcontent-%COMP%]{margin:0 auto;white-space:nowrap;overflow:hidden;width:100%;position:absolute}.marquee[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{display:inline-block;padding-left:100%;animation:_ngcontent-%COMP%_marquee 15s linear infinite}.marquee2[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{animation-delay:5s}@keyframes _ngcontent-%COMP%_marquee{0%{transform:translate(0)}to{transform:translate(-100%)}}.qs[_ngcontent-%COMP%]   .popover[_ngcontent-%COMP%]{background-color:#000000d9;border-radius:5px;top:-3px;height:34px;box-shadow:0 0 5px #0006;color:#fff;display:block;font-size:20px;text-align:center;font-family:Helvetica,sans-serif;left:100%;padding:7px 10px;position:absolute;width:55%;z-index:4}.qs[_ngcontent-%COMP%]   .popover[_ngcontent-%COMP%]:before{border-top:7px solid rgba(0,0,0,.85);border-right:7px solid transparent;border-left:7px solid transparent;bottom:-7px;content:"";display:none;left:50%;margin-left:-7px;position:absolute}.qs[_ngcontent-%COMP%]   .popover[_ngcontent-%COMP%]:hover{background-color:#fff;color:#000000d9;cursor:pointer}']})}return e})()}];let Qr=(()=>{class e{static#e=this.\u0275fac=function(o){return new(o||e)};static#t=this.\u0275mod=t.\u0275\u0275defineNgModule({type:e});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({imports:[M.Bz.forChild(Hr),M.Bz]})}return e})(),Xr=(()=>{class e{static#e=this.\u0275fac=function(o){return new(o||e)};static#t=this.\u0275mod=t.\u0275\u0275defineNgModule({type:e});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({providers:[m.Mi,m.gq,v.YP,m.LF],imports:[S.CommonModule,g.FormsModule,Qr,D._8,F.S,j.D,L.L,V.hJ,Z.QA]})}return e})()}}]);
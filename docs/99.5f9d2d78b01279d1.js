"use strict";(self.webpackChunktest_ng4=self.webpackChunktest_ng4||[]).push([[99],{68099:(nr,D,s)=>{s.r(D),s.d(D,{MyaccountsModule:()=>qo});var S=s(36895),g=s(24006),E=s(70585),F=s(21493),j=s(32137),v=s(10805),L=s(97932),V=s(35593),Z=s(66058),M=s(34793),ye=s(49146),ve=s(27988),_e=s(95343),Ce=s(7585),be=s(53858);const _=function(){try{var e=(0,be.Z)(Object,"defineProperty");return e({},"",{}),e}catch{}}(),N=function Se(e,o,n){"__proto__"==o&&_?_(e,o,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[o]=n};var Me=s(93093),Oe=Object.prototype.hasOwnProperty;const B=function Ie(e,o,n){var r=e[o];(!Oe.call(e,o)||!(0,Me.Z)(r,n)||void 0===n&&!(o in e))&&N(e,o,n)},y=function Pe(e,o,n,r){var a=!n;n||(n={});for(var i=-1,c=o.length;++i<c;){var d=o[i],u=r?r(n[d],e[d],d,n,e):void 0;void 0===u&&(u=e[d]),a?N(n,d,u):B(n,d,u)}return n};var U=s(94157);var De=s(73487),T=s(71999),R=s(11986);var Le=Object.prototype.hasOwnProperty;const Ze=function Ve(e){if(!(0,T.Z)(e))return function Ee(e){var o=[];if(null!=e)for(var n in Object(e))o.push(n);return o}(e);var o=(0,R.Z)(e),n=[];for(var r in e)"constructor"==r&&(o||!Le.call(e,r))||n.push(r);return n};var Ne=s(78706);const O=function Be(e){return(0,Ne.Z)(e)?(0,De.Z)(e,!0):Ze(e)};var Ge=s(25946),G="object"==typeof exports&&exports&&!exports.nodeType&&exports,Y=G&&"object"==typeof module&&module&&!module.nodeType&&module,K=Y&&Y.exports===G?Ge.Z.Buffer:void 0,z=K?K.allocUnsafe:void 0;var $=s(23033);var J=s(6623);const I=(0,s(65820).Z)(Object.getPrototypeOf,Object);var ke=s(33419);const W=Object.getOwnPropertySymbols?function(e){for(var o=[];e;)(0,J.Z)(o,(0,$.Z)(e)),e=I(e);return o}:ke.Z;var ot=s(28501),rt=s(18203);const H=function at(e){return(0,rt.Z)(e,O,W)};var P=s(84116),st=Object.prototype.hasOwnProperty;var Q=s(71630);const A=function dt(e){var o=new e.constructor(e.byteLength);return new Q.Z(o).set(new Q.Z(e)),o};var gt=/\w*$/;var C=s(38492),X=C.Z?C.Z.prototype:void 0,k=X?X.valueOf:void 0;const Ut=function Bt(e,o,n){var r=e.constructor;switch(o){case"[object ArrayBuffer]":return A(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return function ut(e,o){var n=o?A(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function vt(e,o){var n=o?A(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return function ft(e){var o=new e.constructor(e.source,gt.exec(e));return o.lastIndex=e.lastIndex,o}(e);case"[object Symbol]":return function ht(e){return k?Object(k.call(e)):{}}(e)}};var q=Object.create;const Gt=function(){function e(){}return function(o){if(!(0,T.Z)(o))return{};if(q)return q(o);e.prototype=o;var n=new e;return e.prototype=void 0,n}}();var ee=s(14177),zt=s(85202),w=s(214);var te=s(66932),b=s(76594),ne=b.Z&&b.Z.isMap;const Qt=ne?(0,te.Z)(ne):function Jt(e){return(0,w.Z)(e)&&"[object Map]"==(0,P.Z)(e)};var oe=b.Z&&b.Z.isSet;const tn=oe?(0,te.Z)(oe):function kt(e){return(0,w.Z)(e)&&"[object Set]"==(0,P.Z)(e)};var re="[object Arguments]",ae="[object Function]",ie="[object Object]",l={};l[re]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object DataView]"]=l["[object Boolean]"]=l["[object Date]"]=l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Map]"]=l["[object Number]"]=l[ie]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object Symbol]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l["[object Error]"]=l[ae]=l["[object WeakMap]"]=!1;const An=function x(e,o,n,r,a,i){var c,d=1&o,u=2&o,er=4&o;if(n&&(c=a?n(e,r,a,i):n(e)),void 0!==c)return c;if(!(0,T.Z)(e))return e;var ge=(0,ee.Z)(e);if(ge){if(c=function ct(e){var o=e.length,n=new e.constructor(o);return o&&"string"==typeof e[0]&&st.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!d)return function $e(e,o){var n=-1,r=e.length;for(o||(o=Array(r));++n<r;)o[n]=e[n];return o}(e,c)}else{var h=(0,P.Z)(e),fe=h==ae||"[object GeneratorFunction]"==h;if((0,zt.Z)(e))return function Ke(e,o){if(o)return e.slice();var n=e.length,r=z?z(n):new e.constructor(n);return e.copy(r),r}(e,d);if(h==ie||h==re||fe&&!a){if(c=u||fe?{}:function Yt(e){return"function"!=typeof e.constructor||(0,R.Z)(e)?{}:Gt(I(e))}(e),!d)return u?function tt(e,o){return y(e,W(e),o)}(e,function Ue(e,o){return e&&y(o,O(o),e)}(c,e)):function We(e,o){return y(e,(0,$.Z)(e),o)}(e,function Ae(e,o){return e&&y(o,(0,U.Z)(o),e)}(c,e))}else{if(!l[h])return a?e:{};c=Ut(e,h,d)}}i||(i=new _e.Z);var me=i.get(e);if(me)return me;i.set(e,c),tn(e)?e.forEach(function(p){c.add(x(p,o,n,p,e,i))}):Qt(e)&&e.forEach(function(p,f){c.set(f,x(p,o,n,f,e,i))});var he=ge?void 0:(er?u?H:ot.Z:u?O:U.Z)(e);return(0,Ce.Z)(he||e,function(p,f){he&&(p=e[f=p]),B(c,f,x(p,o,n,f,e,i))}),c};var se=s(25575);var En=s(97298);const Vn=function Ln(e,o){return o.length<2?e:(0,En.Z)(e,function Fn(e,o,n){var r=-1,a=e.length;o<0&&(o=-o>a?0:a+o),(n=n>a?a:n)<0&&(n+=a),a=o>n?0:n-o>>>0,o>>>=0;for(var i=Array(a);++r<a;)i[r]=e[r+o];return i}(o,0,-1))};var Zn=s(62168);const Bn=function Nn(e,o){return o=(0,se.Z)(o,e),null==(e=Vn(e,o))||delete e[(0,Zn.Z)(function wn(e){var o=null==e?0:e.length;return o?e[o-1]:void 0}(o))]};var Un=s(77079),ce=Function.prototype.toString,Kn=Object.prototype.hasOwnProperty,zn=ce.call(Object);const Hn=function Wn(e){return function $n(e){if(!(0,w.Z)(e)||"[object Object]"!=(0,Un.Z)(e))return!1;var o=I(e);if(null===o)return!0;var n=Kn.call(o,"constructor")&&o.constructor;return"function"==typeof n&&n instanceof n&&ce.call(n)==zn}(e)?void 0:e};var Qn=s(24825),le=C.Z?C.Z.isConcatSpreadable:void 0;const kn=function Xn(e){return(0,ee.Z)(e)||(0,Qn.Z)(e)||!!(le&&e&&e[le])},qn=function de(e,o,n,r,a){var i=-1,c=e.length;for(n||(n=kn),a||(a=[]);++i<c;){var d=e[i];o>0&&n(d)?o>1?de(d,o-1,n,r,a):(0,J.Z)(a,d):r||(a[a.length]=d)}return a},to=function eo(e){return null!=e&&e.length?qn(e,1):[]},oo=function no(e,o,n){switch(n.length){case 0:return e.call(o);case 1:return e.call(o,n[0]);case 2:return e.call(o,n[0],n[1]);case 3:return e.call(o,n[0],n[1],n[2])}return e.apply(o,n)};var ue=Math.max;const so=function io(e){return function(){return e}};var co=s(79940),po=800,go=16,fo=Date.now;const yo=function mo(e){var o=0,n=0;return function(){var r=fo(),a=go-(r-n);if(n=r,a>0){if(++o>=po)return arguments[0]}else o=0;return e.apply(void 0,arguments)}}(_?function(e,o){return _(e,"toString",{configurable:!0,enumerable:!1,value:so(o),writable:!0})}:co.Z),Mo=function vo(e){return yo(function ro(e,o,n){return o=ue(void 0===o?e.length-1:o,0),function(){for(var r=arguments,a=-1,i=ue(r.length-o,0),c=Array(i);++a<i;)c[a]=r[o+a];a=-1;for(var d=Array(o+1);++a<o;)d[a]=r[a];return d[o]=n(c),oo(e,this,d)}}(e,void 0,to),e+"")}(function(e,o){var n={};if(null==e)return n;var r=!1;o=(0,ve.Z)(o,function(i){return i=(0,se.Z)(i,e),r||(r=i.length>1),i}),y(e,H(e),n),r&&(n=An(n,7,Hn));for(var a=o.length;a--;)Bn(n,o[a]);return n});var pe=s(15439),t=s(94650),m=s(72164);let To=(()=>{class e{transform(n,r){return n&&r?n.filter(a=>a.isPrivate===r.isPrivate):n}static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275pipe=t.\u0275\u0275definePipe({name:"fieldsFilter",type:e,pure:!1})}return e})();const Oo=function(){return{"padding-left":"9px","z-index":"1201"}};function Io(e,o){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"p-calendar",25),t.\u0275\u0275listener("ngModelChange",function(a){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(i.criteria.startingDate=a)}),t.\u0275\u0275elementEnd()}if(2&e){const n=t.\u0275\u0275nextContext(2);t.\u0275\u0275styleMap(t.\u0275\u0275pureFunction0(5,Oo)),t.\u0275\u0275property("ngModel",n.criteria.startingDate)("disabled",n.loadingCS)("inline",!0)}}function Po(e,o){if(1&e&&(t.\u0275\u0275elementStart(0,"option",26),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&e){const n=o.$implicit;t.\u0275\u0275propertyInterpolate("value",n.code),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.name," ")}}function Ao(e,o){if(1&e&&(t.\u0275\u0275elementStart(0,"option",26),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&e){const n=o.$implicit;t.\u0275\u0275propertyInterpolate("value",n.code),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",n.name," ")}}function wo(e,o){if(1&e&&(t.\u0275\u0275elementStart(0,"option",26),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&e){const n=o.$implicit;t.\u0275\u0275propertyInterpolate("value",n._id),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(n.csName)}}const Do=function(){return{isPrivate:!1}},Eo=function(e){return{mask:e,guide:!1}};function Fo(e,o){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div")(1,"div",14)(2,"div",15),t.\u0275\u0275template(3,Io,1,6,"p-calendar",16),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(4,"div",14)(5,"div",17)(6,"select",18),t.\u0275\u0275listener("change",function(){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.getProductsByRegionBrand())})("ngModelChange",function(a){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.criteria.region=a)}),t.\u0275\u0275elementStart(7,"option",19),t.\u0275\u0275text(8,"Choose a region"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(9,Po,2,2,"option",20),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(10,"div",14)(11,"div",17)(12,"select",21),t.\u0275\u0275listener("change",function(){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.getProductsByRegionBrand())})("ngModelChange",function(a){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.criteria.brandName=a)}),t.\u0275\u0275elementStart(13,"option",19),t.\u0275\u0275text(14,"Choose a brand"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(15,Ao,2,2,"option",20),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(16,"div",14)(17,"div",17)(18,"select",22),t.\u0275\u0275listener("ngModelChange",function(a){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.criteria.productCode=a)}),t.\u0275\u0275elementStart(19,"option",19),t.\u0275\u0275text(20,"Choose a product reference"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(21,"option",23),t.\u0275\u0275text(22,"Empty Account"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(23,wo,2,2,"option",20),t.\u0275\u0275pipe(24,"fieldsFilter"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(25,"div",14)(26,"div",17)(27,"input",24),t.\u0275\u0275listener("ngModelChange",function(a){t.\u0275\u0275restoreView(n);const i=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(i.criteria.numberOfPax=a)}),t.\u0275\u0275elementEnd()()()()}if(2&e){const n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",n.display),t.\u0275\u0275advance(3),t.\u0275\u0275property("disabled",n.productsListLoading||n.loadingCS)("ngModel",n.criteria.region),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",n.regionList),t.\u0275\u0275advance(3),t.\u0275\u0275property("disabled",n.productsListLoading||n.loadingCS)("ngModel",n.criteria.brandName),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngForOf",n.brandList),t.\u0275\u0275advance(3),t.\u0275\u0275property("disabled",n.productsListLoading||n.loadingCS)("ngModel",n.criteria.productCode),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngForOf",t.\u0275\u0275pipeBind2(24,13,n.allProductsList,t.\u0275\u0275pureFunction0(16,Do))),t.\u0275\u0275advance(4),t.\u0275\u0275property("textMask",t.\u0275\u0275pureFunction1(17,Eo,n.positiveValuesMask))("disabled",n.loadingCS||"OFF"===n.criteria.productCode)("ngModel",n.criteria.numberOfPax)}}function jo(e,o){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",27),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.newEmptyAccount(a.criteria))}),t.\u0275\u0275elementEnd()}}function Lo(e,o){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",27),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.searchByCriteria(a.criteria))}),t.\u0275\u0275elementEnd()}}function Vo(e,o){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"button",28),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.cancelGenerate())}),t.\u0275\u0275elementEnd()}}const Zo=function(){return{position:"static",width:"50px",height:"50px"}};function No(e,o){1&e&&t.\u0275\u0275element(0,"p-progressSpinner",29),2&e&&t.\u0275\u0275styleMap(t.\u0275\u0275pureFunction0(2,Zo))}function Bo(e,o){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",45),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext().$implicit,i=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(i.editDeparture(a._id))}),t.\u0275\u0275element(1,"i",46),t.\u0275\u0275elementEnd()}}function Uo(e,o){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",45),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(n);const a=t.\u0275\u0275nextContext().$implicit,i=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(i.deleteDeparture(a))}),t.\u0275\u0275element(1,"i",47),t.\u0275\u0275elementEnd()}}function Ro(e,o){1&e&&t.\u0275\u0275element(0,"i",48)}function Go(e,o){1&e&&t.\u0275\u0275element(0,"i",49)}function Yo(e,o){1&e&&t.\u0275\u0275element(0,"i",50)}function Ko(e,o){1&e&&t.\u0275\u0275element(0,"i",51)}function zo(e,o){if(1&e){const n=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",34)(1,"li",35)(2,"div",34)(3,"div",36),t.\u0275\u0275text(4),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(5,"div",37),t.\u0275\u0275listener("click",function(){const i=t.\u0275\u0275restoreView(n).$implicit,c=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(c.viewDeparture(i._id))}),t.\u0275\u0275text(6),t.\u0275\u0275element(7,"i",38),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(8,Bo,2,0,"div",39),t.\u0275\u0275template(9,Uo,2,0,"div",39),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(10,"div",40),t.\u0275\u0275template(11,Ro,1,0,"i",41),t.\u0275\u0275template(12,Go,1,0,"i",42),t.\u0275\u0275template(13,Yo,1,0,"i",43),t.\u0275\u0275template(14,Ko,1,0,"i",44),t.\u0275\u0275elementEnd()()}if(2&e){const n=o.$implicit;t.\u0275\u0275advance(4),t.\u0275\u0275textInterpolate1(" #",n.position," "),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",n.tripCode," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf","draft"===n.state||"rejected"===n.state),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","draft"===n.state||"rejected"===n.state),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf","draft"===n.state),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","submitted"===n.state),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","validated"===n.state),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","rejected"===n.state)}}function $o(e,o){if(1&e&&(t.\u0275\u0275elementStart(0,"div",52),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),2&e){const n=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(n.unavailableDepartures)}}function Jo(e,o){if(1&e&&(t.\u0275\u0275elementStart(0,"div",30)(1,"ul",31),t.\u0275\u0275template(2,zo,15,8,"div",32),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(3,$o,2,1,"div",33),t.\u0275\u0275elementEnd()),2&e){const n=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",n.allDepartures),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",0==n.allDepartures.length&&!n.loadingData)}}function Wo(e,o){1&e&&t.\u0275\u0275element(0,"p-progressSpinner")}const Ho=function(){return{width:"600px"}},Qo=function(){return{"960px":"30vw"}},Xo=[{path:"",component:(()=>{class e{constructor(n,r,a,i,c){this.confirmationService=n,this.router=r,this.datastoreService=a,this.userService=i,this.notificationService=c,this.currentUser={},this.allDepartures=[],this.msgs=[],this.display=!1,this.loadingData=!1,this.isEdit=!1,this.hasError=!1,this.hasResult=!1,this.apiCallLoading=!1,this.isEmptyAccount=!1,this.productsListLoading=!1,this.loadingCS=!1,this.productsDetailArray=[],this.brands=["Gecko"],this.allProductsList=[],this.criteria={startingDate:"",region:"",brandName:"",productCode:"",numberOfPax:""},this.savedCriteria={},this.departureObjectParam={},this.departureObject={},this.notification="",this.csDialogTitle="",this.unavailableDepartures="",this.latestPosition=0,this.validationResult=[],this.emptyAccountsDateMask=[0,1,"/",/[0-1]/,/[0-2]/,"/",/[0-2]/,/[0-9]/,/[0-9]/,/[0-9]/],this.positiveValuesMask=[/^[0-9]\d*$/,/^[0-9]\d*$/],this.brandList=[],this.regionList=[],this.fullRegionList=[]}ngOnInit(){this.loadingData=!0;const n=JSON.parse(localStorage.getItem("appConfig"));this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.brandList=n.brands,this.fullRegionList=n.regions,this.regionList=this.regionsByLeaderID(this.currentUser.regions),this.getAllDeparturesByUserForList(this.currentUser._id)}regionsByLeaderID(n){let r=[];return n.forEach(a=>{this.fullRegionList.forEach(i=>{i.code===a&&r.push(i)})}),r}getProductsByRegionBrand(){""!==this.criteria.region&&""!==this.criteria.brandName&&(this.productsListLoading=!0,this.datastoreService.getProductsByRegionBrand(this.criteria.region,this.criteria.brandName).subscribe(n=>{this.allProductsList=n.data,this.productsListLoading=!1,this.deactivateSpinner()},n=>{console.log(n),this.productsListLoading=!1,this.deactivateSpinner()}))}getAllDeparturesByUserForList(n){this.datastoreService.getAllDeparturesByUserForList(n).subscribe(r=>{r.ok?(this.allDepartures=r.data.sort((a,i)=>i.position-a.position),this.allDepartures.length>0?this.latestPosition=Math.max.apply(Math,this.allDepartures.map(a=>a.position)):(this.latestPosition=0,this.unavailableDepartures="You currently have no departures.")):this.notificationService.addSingle("info","An error occured !",r.message),this.deactivateSpinner()},r=>{console.log(r)})}deleteDeparture(n){this.confirmationService.confirm({message:"Do you want to delete this record?",header:"Delete Confirmation",icon:"fa fa-trash",accept:()=>{this.datastoreService.deleteDeparture(n._id).subscribe(r=>{this.getAllDeparturesByUserForList(this.currentUser._id),r.ok?this.notificationService.addSingle("info","Item Deleted !","You've successfully deleted "+n.tripCode+"."):this.notificationService.addSingle("error","An error occured !",r.message)},r=>{console.log("error :",r)})},reject:()=>{console.log("Rejected")}})}deactivateSpinner(){!this.productsListLoading&&!this.loadingCS&&(this.loadingData=!1)}showDialog(){this.csDialogTitle=this.isEmptyAccount?"Generate New Empty Account":"Generate New Costing Sheets",this.display=!0}cancelGenerate(){this.display=!1,this.criteria={startingDate:"",region:"",brandName:"",productCode:"",numberOfPax:""}}viewDeparture(n){this.router.navigate(["/myaccounts/",n,"view"])}editDeparture(n){this.router.navigate(["/myaccounts/",n,"edit"])}newEmptyAccount(n){this.loadingCS=!0,isNaN(Date.parse(n.startingDate))?(this.notificationService.addSingle("error","Invalid Date","Date entered is invalid"),this.loadingCS=!1,this.deactivateSpinner()):(n.isEmptyAccount=!0,n.startingDate=pe(n.startingDate).format("DD/MM/YYYY"),this.getJsonData(n))}searchByCriteria(n){if(this.loadingCS=!0,this.validationResult=this.isSearchCriteriaValid(n),0===this.validationResult.length)this.apiCallLoading=!0,n.isEmptyAccount=!1,n.startingDate=pe(n.startingDate).format("DD/MM/YYYY"),this.getJsonData(n);else{for(let r=0;r<this.validationResult.length;r++)this.notificationService.addSingle("warn","Validation Warning",this.validationResult[r].message);this.hasError=!0,this.hasResult=!1,this.apiCallLoading=!1,this.loadingCS=!1}}isSearchCriteriaValid(n){let r=[];return n.startingDate||r.push({isValid:!1,message:"Starting date is required"}),n.region||r.push({isValid:!1,message:"Region code is required"}),n.brandName||r.push({isValid:!1,message:"Brand code is required"}),n.productCode||r.push({isValid:!1,message:"Product code is required"}),n.numberOfPax||r.push({isValid:!1,message:"Number of pax is required"}),isNaN(n.numberOfPax)&&r.push({isValid:!1,message:"Number of pax must be a valid number"}),r}getJsonData(n){n.leaderID=null,this.savedCriteria=n,this.departureObject=n,this.datastoreService.getExpensesByCriteria(n).subscribe(r=>{r.position=this.latestPosition+1,this.getCurrentUserVarInfo(r)})}assignCashSummary(n){n.cashSummary=[],0===this.currentUser.cashOnHand.length?this.currentUser.initialCOH.forEach(r=>{n.cashSummary.push({currency:r.currency,startCash:r.cash,endingCash:r.cash})}):this.currentUser.cashOnHand.forEach(r=>{n.cashSummary.push({currency:r.currency,startCash:r.cash,endingCash:r.cash})}),localStorage.setItem("departure",JSON.stringify(n)),this.hasResult=!0,this.hasError=!1,this.apiCallLoading=!1,this.deactivateSpinner(),this.display=!1,this.router.navigate(["/myaccounts/","0","creation"])}getCurrentUserVarInfo(n){this.userService.getCurrentUserVarInfo().subscribe(r=>{r.ok?(this.updateStoredCurrentUser(r.data),this.assignCashSummary(n)):this.notificationService.addSingle("error","An error occured !",r.message)},r=>{console.log(r)})}updateStoredCurrentUser(n){ye.Z(Mo(n,["_id","userCode"]),(r,a)=>{this.currentUser[a]=r}),localStorage.setItem("currentUser",JSON.stringify(this.currentUser))}static#e=this.\u0275fac=function(r){return new(r||e)(t.\u0275\u0275directiveInject(v.YP),t.\u0275\u0275directiveInject(M.F0),t.\u0275\u0275directiveInject(m.Mi),t.\u0275\u0275directiveInject(m.KD),t.\u0275\u0275directiveInject(m.gq))};static#t=this.\u0275cmp=t.\u0275\u0275defineComponent({type:e,selectors:[["app-myaccounts"]],decls:20,vars:17,consts:[[1,"row","justify-content-end"],[1,"col"],[1,"text-muted",2,"text-align","left"],[1,"col-lg-3","col-md-3","col-sm-4"],["type","button",1,"btn","peak-save-button",2,"width","140px",3,"disabled","click"],["header","Generate New Costing Sheets",3,"visible","modal","breakpoints","draggable","resizable","transitionOptions","visibleChange"],["pTemplate","content"],[1,"row","justify-content-center",2,"margin","10px 5px"],["type","button","pButton","","icon","fa fa-check","label","Generate","style","min-width: 130px",3,"click",4,"ngIf"],["type","button","pButton","","icon","fa fa-close","label","Cancel","style","min-width: 130px","class","p-button-secondary",3,"click",4,"ngIf"],["strokeWidth","2",3,"style",4,"ngIf"],[1,"row","justify-content-center"],["class","col-lg-11 col-md-12 col-sm-12",4,"ngIf"],[4,"ngIf"],[1,"row","justify-content-center","rows-spacing"],[1,"col-lg-10","col-md-10","col-sm-12","justify-content-center",2,"display","inline-flex"],["appendTo","body","name","date-picker","dateFormat","dd/mm/yy",3,"ngModel","style","disabled","inline","ngModelChange",4,"ngIf"],[1,"col-lg-8","col-md-10","col-sm-12"],["name","region",1,"form-control",3,"disabled","ngModel","change","ngModelChange"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["name","brandName",1,"form-control",3,"disabled","ngModel","change","ngModelChange"],["name","productReference",1,"form-control",3,"disabled","ngModel","ngModelChange"],["value","OFF"],["type","text","id","numberOfPax","placeholder","Enter number of pax",1,"form-control",3,"textMask","disabled","ngModel","ngModelChange"],["appendTo","body","name","date-picker","dateFormat","dd/mm/yy",3,"ngModel","disabled","inline","ngModelChange"],[3,"value"],["type","button","pButton","","icon","fa fa-check","label","Generate",2,"min-width","130px",3,"click"],["type","button","pButton","","icon","fa fa-close","label","Cancel",1,"p-button-secondary",2,"min-width","130px",3,"click"],["strokeWidth","2"],[1,"col-lg-11","col-md-12","col-sm-12"],[1,"list-group"],["class","row",4,"ngFor","ngForOf"],["style","font-size: 20px;color: grey;text-align: center;border-radius: 10px;padding: 15px;",4,"ngIf"],[1,"row"],[1,"col-md-11","col-lg-11","list-group-item"],[1,"col-1","text-center",2,"padding","10px","max-width","70px !important"],[1,"col-lg-10","col-md-10","col-sm-10","action-buttons",2,"padding","10px",3,"click"],["aria-hidden","true",1,"fa","fa-eye",2,"float","right","line-height","1.5"],["class","col action-buttons text-center","style","padding: 10px; max-width: 80px !important;",3,"click",4,"ngIf"],[1,"col","text-center",2,"margin-bottom","auto","margin-top","auto","max-width","70px !important"],["class","fa fa-copy","aria-hidden","true","style","font-size: 32px; color: gray;",4,"ngIf"],["class","fa fa-spinner","aria-hidden","true","style","font-size: 32px; color: orange;",4,"ngIf"],["class","fa fa-check-circle","aria-hidden","true","style","font-size: 32px; color: forestgreen;",4,"ngIf"],["class","fa fa-ban","aria-hidden","true","style","font-size: 32px; color: darkred;",4,"ngIf"],[1,"col","action-buttons","text-center",2,"padding","10px","max-width","80px !important",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],["aria-hidden","true",1,"fa","fa-trash"],["aria-hidden","true",1,"fa","fa-copy",2,"font-size","32px","color","gray"],["aria-hidden","true",1,"fa","fa-spinner",2,"font-size","32px","color","orange"],["aria-hidden","true",1,"fa","fa-check-circle",2,"font-size","32px","color","forestgreen"],["aria-hidden","true",1,"fa","fa-ban",2,"font-size","32px","color","darkred"],[2,"font-size","20px","color","grey","text-align","center","border-radius","10px","padding","15px"]],template:function(r,a){1&r&&(t.\u0275\u0275elementStart(0,"div")(1,"div",0)(2,"div",1)(3,"h2",2),t.\u0275\u0275text(4,"My Accounts"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(5,"div",3)(6,"button",4),t.\u0275\u0275listener("click",function(){return a.showDialog()}),t.\u0275\u0275text(7,"New Account"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(8,"p-dialog",5),t.\u0275\u0275listener("visibleChange",function(c){return a.display=c}),t.\u0275\u0275template(9,Fo,28,19,"ng-template",6),t.\u0275\u0275elementStart(10,"p-footer",7),t.\u0275\u0275template(11,jo,1,0,"button",8),t.\u0275\u0275template(12,Lo,1,0,"button",8),t.\u0275\u0275template(13,Vo,1,0,"button",9),t.\u0275\u0275template(14,No,1,3,"p-progressSpinner",10),t.\u0275\u0275elementEnd()(),t.\u0275\u0275element(15,"hr"),t.\u0275\u0275elementStart(16,"div",11),t.\u0275\u0275template(17,Jo,4,2,"div",12),t.\u0275\u0275template(18,Wo,1,0,"p-progressSpinner",13),t.\u0275\u0275elementEnd()(),t.\u0275\u0275element(19,"p-confirmDialog")),2&r&&(t.\u0275\u0275advance(6),t.\u0275\u0275property("disabled",a.loadingData),t.\u0275\u0275advance(2),t.\u0275\u0275styleMap(t.\u0275\u0275pureFunction0(15,Ho)),t.\u0275\u0275property("visible",a.display)("modal",!0)("breakpoints",t.\u0275\u0275pureFunction0(16,Qo))("draggable",!1)("resizable",!1)("transitionOptions","0ms"),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf","OFF"===a.criteria.productCode&&!a.loadingCS),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf","OFF"!==a.criteria.productCode&&!a.loadingCS),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!a.loadingCS),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",a.loadingCS),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",!a.loadingData),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",a.loadingData))},dependencies:[S.NgForOf,S.NgIf,g.NgSelectOption,g.\u0275NgSelectMultipleOption,g.DefaultValueAccessor,g.SelectControlValueAccessor,g.NgControlStatus,g.NgModel,E.f,V.Hq,v.$_,v.jx,F.V,j.Q,L.G,Z.hd,To],styles:['.list-group-item[_ngcontent-%COMP%]:focus, .list-group-item[_ngcontent-%COMP%]:hover{background:rgba(0,150,199,.69);color:#fff}.action-buttons[_ngcontent-%COMP%]{padding:0 15px;border:1px solid #a09393;border-width:0 0 0 1px}.action-buttons[_ngcontent-%COMP%]:focus, .action-buttons[_ngcontent-%COMP%]:hover{z-index:1;cursor:pointer}.action-buttons[_ngcontent-%COMP%]:focus   i[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{text-decoration:underline}.rows-spacing[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}.marquee[_ngcontent-%COMP%]{margin:0 auto;white-space:nowrap;overflow:hidden;width:100%;position:absolute}.marquee[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{display:inline-block;padding-left:100%;animation:_ngcontent-%COMP%_marquee 15s linear infinite}.marquee2[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{animation-delay:5s}@keyframes _ngcontent-%COMP%_marquee{0%{transform:translate(0)}to{transform:translate(-100%)}}.qs[_ngcontent-%COMP%]   .popover[_ngcontent-%COMP%]{background-color:#000000d9;border-radius:5px;top:-3px;height:34px;box-shadow:0 0 5px #0006;color:#fff;display:block;font-size:20px;text-align:center;font-family:Helvetica,sans-serif;left:100%;padding:7px 10px;position:absolute;width:55%;z-index:4}.qs[_ngcontent-%COMP%]   .popover[_ngcontent-%COMP%]:before{border-top:7px solid rgba(0,0,0,.85);border-right:7px solid transparent;border-left:7px solid transparent;bottom:-7px;content:"";display:none;left:50%;margin-left:-7px;position:absolute}.qs[_ngcontent-%COMP%]   .popover[_ngcontent-%COMP%]:hover{background-color:#fff;color:#000000d9;cursor:pointer}']})}return e})()}];let ko=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=t.\u0275\u0275defineNgModule({type:e});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({imports:[M.Bz.forChild(Xo),M.Bz]})}return e})(),qo=(()=>{class e{static#e=this.\u0275fac=function(r){return new(r||e)};static#t=this.\u0275mod=t.\u0275\u0275defineNgModule({type:e});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({providers:[m.Mi,m.gq,v.YP,m.LF],imports:[S.CommonModule,g.FormsModule,ko,E._8,F.S,j.D,L.L,V.hJ,Z.QA]})}return e})()}}]);
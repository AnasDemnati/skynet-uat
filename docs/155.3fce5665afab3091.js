"use strict";(self.webpackChunktest_ng4=self.webpackChunktest_ng4||[]).push([[155],{93155:(O,f,o)=>{o.r(f),o.d(f,{ProductsModule:()=>N});var p=o(36895),c=o(24006),P=o(52885),m=o(32137),x=o(35593),C=o(21493),h=o(97932),v=o(10805),S=o(17456),u=o(34793),t=o(94650),d=o(72164),_=o(60766);function y(n,a){if(1&n){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",27),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const e=t.\u0275\u0275nextContext().$implicit,s=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(s.deleteProduct(e._id))}),t.\u0275\u0275element(1,"i",30),t.\u0275\u0275elementEnd()}}function F(n,a){if(1&n){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"li",22)(1,"div",23)(2,"div",24),t.\u0275\u0275text(3),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",25),t.\u0275\u0275listener("click",function(){const s=t.\u0275\u0275restoreView(i).$implicit,l=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(l.viewProduct(s))}),t.\u0275\u0275text(5),t.\u0275\u0275element(6,"i",26),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(7,"div",27),t.\u0275\u0275listener("click",function(){const s=t.\u0275\u0275restoreView(i).$implicit,l=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(l.editProduct(s))}),t.\u0275\u0275element(8,"i",28),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(9,y,2,0,"div",29),t.\u0275\u0275elementEnd()()}if(2&n){const i=a.$implicit,r=a.index,e=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate1(" ",e.offset+r+1," "),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",i.csName," "),t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf","admin"===e.currentRole)}}function E(n,a){if(1&n&&(t.\u0275\u0275elementStart(0,"div",19)(1,"ul",20),t.\u0275\u0275template(2,F,10,3,"li",21),t.\u0275\u0275elementEnd()()),2&n){const i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(2),t.\u0275\u0275property("ngForOf",i.allProducts)}}function I(n,a){1&n&&(t.\u0275\u0275elementStart(0,"div",31),t.\u0275\u0275text(1," Loading data ... "),t.\u0275\u0275elementEnd())}function k(n,a){1&n&&(t.\u0275\u0275elementStart(0,"div",31),t.\u0275\u0275text(1," No data available. "),t.\u0275\u0275elementEnd())}const b=function(){return{position:"absolute",top:"25%",left:"50%"}};function D(n,a){1&n&&t.\u0275\u0275element(0,"p-progressSpinner"),2&n&&t.\u0275\u0275styleMap(t.\u0275\u0275pureFunction0(2,b))}const g=function(n){return{disabled:n}},w=[{path:"",component:(()=>{class n{constructor(i,r,e,s,l){this.router=i,this.confirmationService=r,this.notificationService=e,this.roleGuard=s,this.datastoreService=l,this.allProducts=[],this.costingSheet=[],this.currentRole="",this.productQuery={},this.loadingData=!1,this.serverError=!1,this.offset=0,this.totalRecords=0,this.pageFilter=10}ngOnInit(){this.loadingData=!0,this.serverError=!1,this.currentRole=this.roleGuard.getCurrentRole(),this.getProductsByOffset(this.offset,this.pageFilter),this.getProductsCount()}getProductsByOffset(i,r){this.serverError=!1,this.datastoreService.getProductsByOffset(i,r).subscribe(e=>{e.ok?this.allProducts=e.data:(this.notificationService.addSingle("error","An error occured !",e.message),this.serverError=!0),this.loadingData=!1},e=>{console.log(e),this.notificationService.addSingle("error","Server error",""),this.refreshNotification(),this.serverError=!0,this.loadingData=!1})}getProductsCount(){this.datastoreService.getProductsCount().subscribe(i=>{i.ok?this.totalRecords=i.data:(this.notificationService.addSingle("error","An error occured !",i.message),this.serverError=!0),this.loadingData=!1},i=>{console.log(i),this.notificationService.addSingle("error","Server error",""),this.refreshNotification(),this.serverError=!0,this.loadingData=!1})}pageFilterChange(){this.firstPage()}firstPage(){this.loadingData=!0,this.offset=0,this.getProductsByOffset(this.offset,this.pageFilter)}lastPage(){this.loadingData=!0,this.offset=this.totalRecords%this.pageFilter==0?(parseInt((this.totalRecords/this.pageFilter).toString(),10)-1)*this.pageFilter:parseInt((this.totalRecords/this.pageFilter).toString(),10)*this.pageFilter,this.getProductsByOffset(this.offset,this.pageFilter)}nextPage(){this.loadingData=!0,this.offset=parseInt(this.offset.toString(),10)+parseInt(this.pageFilter.toString(),10),this.getProductsByOffset(this.offset,this.pageFilter)}previousPage(){this.loadingData=!0,this.offset-=this.pageFilter,this.getProductsByOffset(this.offset,this.pageFilter)}newProduct(){this.router.navigate(["/products/","creation"])}viewProduct(i){localStorage.setItem("product",JSON.stringify(i)),this.router.navigate(["/products/","view"])}refreshNotification(){this.notificationService.addSingle("info","","Please refresh.")}editProduct(i){localStorage.setItem("product",JSON.stringify(i)),this.router.navigate(["/products/","edit"])}deleteProduct(i){this.confirmationService.confirm({message:"Do you want to delete this record?",header:"Delete Confirmation",icon:"fa fa-trash",accept:()=>{this.datastoreService.deleteProduct(i).subscribe(r=>{this.getProductsByOffset(this.offset,this.pageFilter),r.ok?this.notificationService.addSingle("info","Item Deleted !","You've successfully deleted "+r.data.productCode+"."):(this.notificationService.addSingle("error","An error occured !",r.message),this.serverError=!0),this.loadingData=!1},r=>{console.log(r),this.notificationService.addSingle("error","Server error",""),this.refreshNotification(),this.serverError=!0,this.loadingData=!1})},reject:()=>{console.log("Rejected")}})}static#t=this.\u0275fac=function(r){return new(r||n)(t.\u0275\u0275directiveInject(u.F0),t.\u0275\u0275directiveInject(v.YP),t.\u0275\u0275directiveInject(d.gq),t.\u0275\u0275directiveInject(_.k4),t.\u0275\u0275directiveInject(d.Mi))};static#e=this.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-products"]],decls:43,vars:20,consts:[[2,"margin","auto 100px"],[1,"text-muted"],[1,"row","justify-content-end"],[1,"col-md-1"],["type","button",1,"btn","peak-save-button",2,"width","140px",3,"click"],[1,"row","justify-content-end",2,"margin-bottom","10px"],[1,"col-md-2"],["id","page_size",1,"form-control",2,"padding","0",3,"ngModel","ngModelChange","change"],[1,"row"],["class","col-md-12",4,"ngIf"],["style","font-size: 20px;color: grey;text-align: center;border-radius: 10px;padding: 15px;",4,"ngIf"],["aria-label","Page navigation example",2,"margin-top","10px","margin-right","auto","margin-left","auto","width","fit-content"],[1,"pagination"],[1,"page-item","text-center",2,"width","100px",3,"ngClass"],[1,"page-link",3,"click"],[1,"page-item",2,"width","100px",3,"ngClass"],[1,"page-link","text-center",3,"click"],[3,"blocked"],[3,"style",4,"ngIf"],[1,"col-md-12"],[1,"list-group"],["class","list-group-item row","style","padding: 0;",4,"ngFor","ngForOf"],[1,"list-group-item","row",2,"padding","0"],[1,"row",2,"padding-left","10px"],[1,"col","text-center",2,"padding","10px","max-width","70px !important"],[1,"col-md-10","action-buttons",2,"padding","10px",3,"click"],["aria-hidden","true",1,"fa","fa-eye",2,"float","right"],[1,"col","action-buttons","text-center",2,"padding","10px","max-width","80px !important",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],["class","col action-buttons text-center","style","padding: 10px; max-width: 80px !important;",3,"click",4,"ngIf"],["aria-hidden","true",1,"fa","fa-trash"],[2,"font-size","20px","color","grey","text-align","center","border-radius","10px","padding","15px"]],template:function(r,e){1&r&&(t.\u0275\u0275elementStart(0,"div",0)(1,"h2",1),t.\u0275\u0275text(2,"Products List"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(3,"hr"),t.\u0275\u0275elementStart(4,"div",2)(5,"div",3)(6,"button",4),t.\u0275\u0275listener("click",function(){return e.newProduct()}),t.\u0275\u0275text(7,"New Product"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275element(8,"hr"),t.\u0275\u0275elementStart(9,"div",5)(10,"div",6)(11,"select",7),t.\u0275\u0275listener("ngModelChange",function(l){return e.pageFilter=l})("change",function(){return e.pageFilterChange()}),t.\u0275\u0275elementStart(12,"option"),t.\u0275\u0275text(13,"10"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"option"),t.\u0275\u0275text(15,"20"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(16,"option"),t.\u0275\u0275text(17,"50"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(18,"option"),t.\u0275\u0275text(19,"100"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(20,"div",6),t.\u0275\u0275text(21),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(22,"div",8),t.\u0275\u0275template(23,E,3,1,"div",9),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(24,I,2,0,"div",10),t.\u0275\u0275template(25,k,2,0,"div",10),t.\u0275\u0275elementStart(26,"nav",11)(27,"ul",12)(28,"li",13)(29,"a",14),t.\u0275\u0275listener("click",function(){return e.firstPage()}),t.\u0275\u0275text(30," First "),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(31,"li",15)(32,"a",16),t.\u0275\u0275listener("click",function(){return e.previousPage()}),t.\u0275\u0275text(33," Previous "),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(34,"li",13)(35,"a",14),t.\u0275\u0275listener("click",function(){return e.nextPage()}),t.\u0275\u0275text(36," Next "),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(37,"li",13)(38,"a",14),t.\u0275\u0275listener("click",function(){return e.lastPage()}),t.\u0275\u0275text(39," Last "),t.\u0275\u0275elementEnd()()()()(),t.\u0275\u0275elementStart(40,"p-blockUI",17),t.\u0275\u0275template(41,D,1,3,"p-progressSpinner",18),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(42,"p-confirmDialog")),2&r&&(t.\u0275\u0275advance(11),t.\u0275\u0275property("ngModel",e.pageFilter),t.\u0275\u0275advance(10),t.\u0275\u0275textInterpolate2(" ",+e.offset+e.allProducts.length," / ",e.totalRecords," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",!e.serverError&&!e.loadingData),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.loadingData),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.serverError),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(12,g,0===e.offset)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(14,g,0===e.offset)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(16,g,e.allProducts.length<e.pageFilter)),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(18,g,e.allProducts.length<e.pageFilter)),t.\u0275\u0275advance(3),t.\u0275\u0275property("blocked",e.loadingData),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",e.loadingData))},dependencies:[p.NgClass,p.NgForOf,p.NgIf,c.NgSelectOption,c.\u0275NgSelectMultipleOption,c.SelectControlValueAccessor,c.NgControlStatus,c.NgModel,m.Q,h.G,S.b],styles:[".action-buttons[_ngcontent-%COMP%]{padding:0 15px;border:1px solid #e0e0e0;border-width:0 0 0 1px}.action-buttons[_ngcontent-%COMP%]:focus, .action-buttons[_ngcontent-%COMP%]:hover{z-index:1;text-decoration:none;background:rgba(0,150,199,.69);color:#fff}"]})}return n})()}];let M=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({imports:[u.Bz.forChild(w),u.Bz]})}return n})(),N=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=t.\u0275\u0275defineInjector({providers:[d.Mi,d.gq,v.YP,d.ez],imports:[p.CommonModule,c.FormsModule,M,C.S,m.D,h.L,x.hJ,P.IJ,S.u]})}return n})()}}]);